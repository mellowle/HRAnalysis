<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace属性是名称空间，必须唯一 -->
<mapper namespace="dao.Mapper">

    <select id="isTableExist" resultType="int">
        SELECT COUNT(*) from information_schema.TABLES where table_name = #{tableName}
    </select>

    <update id="deleteTable">
        DROP TABLE ${tableName}
    </update>

    <update id="createTable">
        CREATE TABLE `${newTableName}` (
        <foreach item="item" index="index" collection="columns" open="" separator="," close=",">
            `${item.code}`
            <choose>
                <when test="item.type=='varchar'">
                    varchar(255) DEFAULT NULL
                </when>
                <otherwise>
                    ${item.type} DEFAULT NULL
                </otherwise>
            </choose>
        </foreach>
        `id` bigint(21) PRIMARY KEY NOT NULL AUTO_INCREMENT
        )ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8;
    </update>

    <insert id="addCompensation" parameterType="entity.excelEntity.Compensation" useGeneratedKeys="true"
            keyProperty="id">
        INSERT INTO compensation
        (wwid,bonus2016,bonus2017,bonus2018)
        VALUES
        (#{wwid},#{bonus2016},#{bonus2017},#{bonus2018})
    </insert>

    <insert id="addDirectReport" parameterType="entity.excelEntity.DirectReport" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO direct_report
        (wwid, direct_report)
        VALUES
        (#{wwid},#{direct_report})
    </insert>

    <insert id="addEducation" parameterType="entity.excelEntity.Education" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO education
        (wwid, highest_degree_received)
        VALUES
        (#{wwid},#{highest_degree_received})
    </insert>

    <insert id="addEmployeeDemographics" parameterType="entity.excelEntity.EmployeeDemographics" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO employee_demographics
        (wwid, employee_pay_grade,home_location_code,position_id,job_profile,job_profile_id,job_function,job_sub_function,sector,time_in_position,length_of_service_in_years,original_hire_date,hire_date_most_recent)
        VALUES
        (#{wwid}, #{employee_pay_grade},#{home_location_code},#{position_id},#{job_profile},#{job_profile_id},#{job_function},#{job_sub_function},#{sector},#{time_in_position},#{length_of_service_in_years},#{original_hire_date},#{hire_date_most_recent})
    </insert>

    <insert id="addManagementChain" parameterType="entity.excelEntity.ManagementChain" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO management_chain
        (wwid, management_chain_level_01,management_chain_level_02,management_chain_level_03,management_chain_level_04,management_chain_level_05,management_chain_level_06,management_chain_level_07,management_chain_level_08,management_chain_level_09,hierarchy_count)
        VALUES
        (#{wwid}, #{management_chain_level_01},#{management_chain_level_02},#{management_chain_level_03},#{management_chain_level_04},#{management_chain_level_05},#{management_chain_level_06},#{management_chain_level_07},#{management_chain_level_08},#{management_chain_level_09},#{hierarchy_count})
    </insert>

    <insert id="addPerformanceRatingFixed" parameterType="entity.excelEntity.fixed.PerformanceRatingFixed" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO performance_rating_fixed
        (wwid, overall_rating2016, overall_rating2017, overall_rating2018)
        VALUES
        (#{wwid}, #{overall_rating2016}, #{overall_rating2017}, #{overall_rating2018})
    </insert>

    <insert id="addTalentCard" parameterType="entity.excelEntity.TalentCard" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO talent_card
        (wwid,jnj_roles,external_roles,total_roles,average_time_of_jnj_role,average_time_of_external_role,total_working_year,external_length_of_service,average_time_of_each_role )
        VALUES
        (#{wwid},#{jnj_roles},#{external_roles},#{total_roles},#{average_time_of_jnj_role},#{average_time_of_external_role},#{total_working_year},#{external_length_of_service},#{average_time_of_each_role} )
    </insert>

    <insert id="addUnstructuredData" parameterType="entity.excelEntity.UnstructuredData" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO unstructured_data
        (wwid, performance_comments2018,stakeholder_feedback)
        VALUES
        (#{wwid}, #{performance_comments2018},#{stakeholder_feedback})
    </insert>

    <insert id="addWorkerChangeHistoryFixed" parameterType="entity.excelEntity.fixed.WorkerChangeHistoryFixed" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO worker_change_history_fixed
        (wwid,function_movements,lateral_movements,promotions,region_movements,country_movements,sector_movements)
        VALUES
        (#{wwid}, #{function_movements}, #{lateral_movements}, #{promotions}, #{region_movements}, #{country_movements}, #{sector_movements})
    </insert>

<!--Experiences-->
    <select id="getAllDExperiences" resultType="entity.dimensionRawData.DExperiences">
        SELECT compet.wwid,
        ed.employee_pay_grade, ed.job_function, ed.sector, ed.length_of_service_in_years,
        edu.highest_degree_received,
        p.overall_rating2016, p.overall_rating2017, p.overall_rating2018,
        compen.bonus2016,compen.bonus2017,compen.bonus2018,
        w.function_movements, w.lateral_movements, w.promotions, w.region_movements, w.country_movements, w.sector_movements,
        d.direct_report,
        mc.hierarchy_count,
        t.jnj_roles, t.external_roles, t.total_roles, t.average_time_of_jnj_role, t.average_time_of_external_role, t.total_working_year, t.external_length_of_service, t.average_time_of_each_role,
        un.performance_comments2018, un.stakeholder_feedback
        FROM competencies compet
        LEFT JOIN employee_demographics ed ON compet.wwid = ed.wwid
        LEFT JOIN education edu ON compet.wwid = edu.wwid
        LEFT JOIN performance_rating_fixed p ON compet.wwid = p.wwid
        LEFT JOIN compensation compen ON compet.wwid = compen.wwid
        LEFT JOIN worker_change_history_fixed w ON compet.wwid = w.wwid
        LEFT JOIN direct_report d ON compet.wwid = d.wwid
        LEFT JOIN management_chain mc ON compet.wwid = mc.wwid
        LEFT JOIN talent_card t ON compet.wwid = t.wwid
        LEFT JOIN unstructured_data un ON compet.wwid = un.wwid
    </select>

    <insert id="addDExperiences" parameterType="entity.dimensionRawData.DExperiences" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO experiences
        (wwid,employee_pay_grade,job_function,sector,length_of_service_in_years,highest_degree_received,overall_rating2016,overall_rating2017,overall_rating2018,bonus2016,bonus2017,bonus2018,function_movements,lateral_movements,promotions,region_movements,country_movements,sector_movements,direct_report,hierarchy_count,jnj_roles,external_roles,total_roles,average_time_of_jnj_role,average_time_of_external_role,total_working_year,external_length_of_service,average_time_of_each_role,performance_comments2018,stakeholder_feedback )
        VALUES
        (#{wwid},#{employee_pay_grade},#{job_function},#{sector},#{length_of_service_in_years},#{highest_degree_received},#{overall_rating2016},#{overall_rating2017},#{overall_rating2018},#{bonus2016},#{bonus2017},#{bonus2018},#{function_movements},#{lateral_movements},#{promotions},#{region_movements},#{country_movements},#{sector_movements},#{direct_report},#{hierarchy_count},#{jnj_roles},#{external_roles},#{total_roles},#{average_time_of_jnj_role},#{average_time_of_external_role},#{total_working_year},#{external_length_of_service},#{average_time_of_each_role},#{performance_comments2018},#{stakeholder_feedback} )
    </insert>

    <insert id="addDExperiencesScored" parameterType="entity.dimensionScored.DExperiencesScored" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO d_experiences_scored
        (wwid, employee_pay_grade, job_function, sector, length_of_service_in_years, team_size, performance_rating2016, performance_rating2017, performance_rating2018, bonus_increment20162017, bonus_increment20172018, function_movements, lateral_movements, promotions, region_movements, country_movements, sector_movements, external_roles, external_length_of_service, role_number_ranking, total_working_year_ranking, average_time_of_each_role_ranking, hierarchy_count, performance_comments2018, stakeholder_feedback, data_completeness, result)
        VALUES
        (#{wwid},#{employee_pay_grade},#{job_function},#{sector},#{length_of_service_in_years},#{team_size},#{performance_rating2016},#{performance_rating2017},#{performance_rating2018},#{bonus_increment20162017},#{bonus_increment20172018},#{function_movements},#{lateral_movements},#{promotions},#{region_movements},#{country_movements},#{sector_movements},#{external_roles},#{external_length_of_service},#{role_number_ranking},#{total_working_year_ranking},#{average_time_of_each_role_ranking},#{hierarchy_count},#{performance_comments2018},#{stakeholder_feedback},#{data_completeness},#{result})
    </insert>

    <!--Experiences-->


<!--KF4D-->
    <insert id="addCompetencies" parameterType="entity.excelEntity.Competencies" useGeneratedKeys="true"
            keyProperty="id">
        INSERT INTO competencies
        (wwid,action_oriented,balances_stakeholders,being_resilient,builds_effective_teams,builds_networks,collaborates,communicates_effectively,courage,cultivates_innovation,customer_focus,decision_quality,develops_talent,directs_work,drives_engagement,drives_results,ensures_accountability,global_perspective,instills_trust,interpersonal_savvy,manages_ambiguity,manages_conflict,nimble_learning,optimizes_work_processes,persuades,plans_and_aligns,resourcefulness,self_development,situational_adaptability,strategic_mindset,values_differences)
        VALUES
        (#{wwid},#{action_oriented},#{balances_stakeholders},#{being_resilient},#{builds_effective_teams},#{builds_networks},#{collaborates},#{communicates_effectively},#{courage},#{cultivates_innovation},#{customer_focus},#{decision_quality},#{develops_talent},#{directs_work},#{drives_engagement},#{drives_results},#{ensures_accountability},#{global_perspective},#{instills_trust},#{interpersonal_savvy},#{manages_ambiguity},#{manages_conflict},#{nimble_learning},#{optimizes_work_processes},#{persuades},#{plans_and_aligns},#{resourcefulness},#{self_development},#{situational_adaptability},#{strategic_mindset},#{values_differences})
    </insert>

    <insert id="addDrivers" parameterType="entity.excelEntity.Drivers" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO drivers
        (wwid, balance,challenge,collaboration,independence,power,structure)
        VALUES
        (#{wwid},#{balance},#{challenge},#{collaboration},#{independence},#{power},#{structure})
    </insert>

    <insert id="addTraits" parameterType="entity.excelEntity.Traits" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO traits
        (wwid, adaptability,affiliation,assertiveness,composure,confidence,credibility,curiosity,empathy,focus,humility,influence,need_for_achievement,openness_to_differences,optimism,persistence,risk_taking,situational_self_awareness,sociability,tolerance_of_ambiguity,trust)
        VALUES
        (#{wwid}, #{adaptability}, #{affiliation}, #{assertiveness}, #{composure}, #{confidence}, #{credibility}, #{curiosity}, #{empathy}, #{focus}, #{humility}, #{influence}, #{need_for_achievement}, #{openness_to_differences}, #{optimism}, #{persistence}, #{risk_taking}, #{situational_self_awareness}, #{sociability}, #{tolerance_of_ambiguity}, #{trust})
    </insert>

    <select id="getAllCompetencies" resultType="entity.excelEntity.Competencies">
        SELECT * FROM competencies
    </select>

    <insert id="addDCompetenciesScored" parameterType="entity.dimensionScored.DCompetenciesScored" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO d_competencies_scored
        (wwid, action_oriented, balances_stakeholders, being_resilient, builds_effective_teams, builds_networks, collaborates, communicates_effectively, courage, cultivates_innovation, customer_focus, decision_quality, develops_talent, directs_work, drives_engagement, drives_results, ensures_accountability, global_perspective, instills_trust, interpersonal_savvy, manages_ambiguity, manages_conflict, nimble_learning, optimizes_work_processes, persuades, plans_and_aligns, resourcefulness, self_development, situational_adaptability, strategic_mindset, values_differences, result)
        VALUES
        (#{wwid}, #{action_oriented}, #{balances_stakeholders}, #{being_resilient}, #{builds_effective_teams}, #{builds_networks}, #{collaborates}, #{communicates_effectively}, #{courage}, #{cultivates_innovation}, #{customer_focus}, #{decision_quality}, #{develops_talent}, #{directs_work}, #{drives_engagement}, #{drives_results}, #{ensures_accountability}, #{global_perspective}, #{instills_trust}, #{interpersonal_savvy}, #{manages_ambiguity}, #{manages_conflict}, #{nimble_learning}, #{optimizes_work_processes}, #{persuades}, #{plans_and_aligns}, #{resourcefulness}, #{self_development}, #{situational_adaptability}, #{strategic_mindset}, #{values_differences}, #{result})
    </insert>

    <select id="getAllDrivers" resultType="entity.excelEntity.Drivers">
        SELECT * FROM drivers
    </select>

    <insert id="addDDriversScored" parameterType="entity.dimensionScored.DDriversScored" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO d_drivers_scored
        (wwid, balance,challenge,collaboration,independence,power,structure,result)
        VALUES
        (#{wwid}, #{balance},#{challenge},#{collaboration},#{independence},#{power},#{structure},#{result})
    </insert>

    <select id="getAllTraits" resultType="entity.excelEntity.Traits">
        SELECT * FROM traits
    </select>

    <insert id="addDTraitsScored" parameterType="entity.dimensionScored.DTraitsScored" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO d_traits_scored
        (trust, empathy, need_for_achievement, composure, curiosity, optimism, humility, confidence, focus, openness_to_differences, risk_taking, adaptability, wwid, situational_self_awareness, influence, sociability, result, affiliation, persistence, credibility, tolerance_of_ambiguity, assertiveness)
        VALUES
        (#{trust}, #{empathy}, #{need_for_achievement}, #{composure}, #{curiosity}, #{optimism}, #{humility}, #{confidence}, #{focus}, #{openness_to_differences}, #{risk_taking}, #{adaptability}, #{wwid}, #{situational_self_awareness}, #{influence}, #{sociability}, #{result}, #{affiliation}, #{persistence}, #{credibility}, #{tolerance_of_ambiguity}, #{assertiveness})
    </insert>
<!--KF4D-->














    <!--    <insert id="addWorkChangeHistory" parameterType="entity.excelEntity.WorkerChangeHistory" useGeneratedKeys="true" keyProperty="id">-->
    <!--        insert into worker_change_history(wwid, business_process_effective_date,business_process_status,business_process_type,business_process_reason,business_process_completed_date,position_current,position_proposed,region_current,region_proposed,company_current,company_proposed,job_profile_current,job_profile_proposed,location_current,location_proposed,compensation_grade_current,compensation_grade_proposed,pay_group_change,base_pay_current,base_pay_proposed,base_pay_change_amount,base_pay_change_percent) values(#{wwid}, #{business_process_effective_date},#{business_process_status},#{business_process_type},#{business_process_reason},#{business_process_completed_date},#{position_current},#{position_proposed},#{region_current},#{region_proposed},#{company_current},#{company_proposed},#{job_profile_current},#{job_profile_proposed},#{location_current},#{location_proposed},#{compensation_grade_current},#{compensation_grade_proposed},#{pay_group_change},#{base_pay_current},#{base_pay_proposed},#{base_pay_change_amount},#{base_pay_change_percent})-->
    <!--    </insert>-->











    <!--    &lt;!&ndash;get raw table for fix table&ndash;&gt;-->
    <!--    <select id="getAllEducation" resultType="entity.excelEntity.Education">-->
    <!--        select * from education-->
    <!--    </select>-->

    <!--    <select id="getAllWorkChangeHistory" resultType="entity.excelEntity.WorkerChangeHistory">-->
    <!--        select * from worker_change_history-->
    <!--    </select>-->

    <!--    <select id="getAllPerformanceRating" resultType="entity.excelEntity.PerformanceRating">-->
    <!--        select * from performance_rating-->
    <!--    </select>-->


    <!--    &lt;!&ndash;insert value to fix table&ndash;&gt;-->
    <!--    <insert id="addFixedEducation" parameterType="fixedEntity.EducationFixed" useGeneratedKeys="true" keyProperty="id">-->
    <!--        insert into education_fixed(wwid, highestEducation) values(#{wwid}, #{highestEducation})-->
    <!--    </insert>-->



    <!--    <insert id="addFixedPerformanceRating" parameterType="entity.excelEntity.fixed.PerformanceRatingFixed" useGeneratedKeys="true" keyProperty="id">-->
    <!--        insert into performance_rating_fixed(wwid, overallRating2016, overallRating2017, overallRating2018) values(#{wwid}, #{overallRating2016}, #{overallRating2017}, #{overallRating2018})-->
    <!--    </insert>-->




    <!--    <select id="getAllExperiences" resultType="entity.dimensionRawData.DExperiences">-->
    <!--        select * from experiences-->
    <!--    </select>-->

</mapper>


